{"version":3,"sources":["../src/types.ts","../src/constants.ts","../src/utils/registry-providers/azure.ts","../src/utils/blocks/utils/strings.ts","../src/utils/registry-providers/bitbucket.ts","../src/utils/registry-providers/github.ts","../src/utils/registry-providers/gitlab.ts","../src/utils/blocks/utils/url.ts","../src/utils/registry-providers/http.ts","../src/utils/blocks/types/result.ts","../src/utils/manifest.ts","../src/utils/registry-providers/index.ts"],"names":["blockSchema","categorySchema","manifestMeta","manifestSchema","MANIFEST_FILE","CONFIG_FILE","DEFAULT_BRANCH","azure","url","opts","parsed","parseUrl","owner","repoName","normalizedUrl","project","ref","refs","state","resourcePath","versionType","token","filePath","color","fullyQualified","repo","rest","specifier","startsWithOneOf","str","strings","s","bitbucket","f","headers","key","value","response","github","octokit","Octokit","tags","tag","gitlab","tempRef","join","segments","removeLeadingAndTrailingSlash","segment","newSegment","removeLeadingSlash","removeTrailingSlash","addTrailingSlash","http","u","error","parsedUrl","Result","result","success","failure","fn","val","Ok","err","Err","defaultVal","_","def","message","parseManifest","json","validated","w","providers","selectProvider","p","fetchRaw","verbose","fetchManifest","manifest"],"mappings":"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","file":"chunk-QDKEPRMN.js","sourcesContent":["import * as v from 'valibot';\n\nexport const blockSchema = v.object({\n\tname: v.string(),\n\tcategory: v.string(),\n\tlocalDependencies: v.array(v.string()),\n\tdependencies: v.array(v.string()),\n\tdevDependencies: v.array(v.string()),\n\ttests: v.boolean(),\n\tlist: v.optional(v.boolean(), true),\n\t/** Where to find the block relative to root */\n\tdirectory: v.string(),\n\tsubdirectory: v.boolean(),\n\tfiles: v.array(v.string()),\n\t_imports_: v.record(v.string(), v.string()),\n});\n\nexport const categorySchema = v.object({\n\tname: v.string(),\n\tblocks: v.array(blockSchema),\n});\n\nexport const manifestMeta = v.object({\n\tauthors: v.optional(v.array(v.string())),\n\tbugs: v.optional(v.string()),\n\tdescription: v.optional(v.string()),\n\thomepage: v.optional(v.string()),\n\trepository: v.optional(v.string()),\n\ttags: v.optional(v.array(v.string())),\n});\n\nexport const manifestSchema = v.object({\n\tmeta: v.optional(manifestMeta),\n\tcategories: v.array(categorySchema),\n});\n\nexport type Meta = v.InferOutput<typeof manifestMeta>;\n\nexport type Category = v.InferOutput<typeof categorySchema>;\n\nexport type Block = v.InferOutput<typeof blockSchema>;\n\nexport type Manifest = v.InferOutput<typeof manifestSchema>;\n","export const MANIFEST_FILE = 'jsrepo-manifest.json';\nexport const CONFIG_FILE = 'jsrepo.json';\n","import color from 'chalk';\nimport type { ParseOptions, RegistryProvider, RegistryProviderState } from './types';\n\nconst DEFAULT_BRANCH = 'main';\n\nexport interface AzureProviderState extends RegistryProviderState {\n\towner: string;\n\trepoName: string;\n\tproject: string;\n\trefs: 'heads' | 'tags';\n\tref: string;\n}\n\n/** Valid paths\n *\n *  `azure/<org>/<project>/<repo>/(tags|heads)/<ref>`\n */\nexport const azure: RegistryProvider = {\n\tname: 'azure',\n\n\tmatches: (url) => url.toLowerCase().startsWith('azure'),\n\n\tparse: (url, opts) => {\n\t\tconst parsed = parseUrl(url, opts);\n\n\t\treturn {\n\t\t\turl: parsed.url,\n\t\t\tspecifier: parsed.specifier,\n\t\t};\n\t},\n\n\tbaseUrl: (url) => {\n\t\tconst { owner, repoName } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn `https://dev.azure.com/${owner}/_git/${repoName}`;\n\t},\n\n\tstate: async (url) => {\n\t\tconst {\n\t\t\turl: normalizedUrl,\n\t\t\towner,\n\t\t\tproject,\n\t\t\trepoName,\n\t\t\tref,\n\t\t\trefs,\n\t\t} = parseUrl(url, { fullyQualified: false });\n\n\t\treturn {\n\t\t\towner,\n\t\t\trepoName,\n\t\t\tref,\n\t\t\trefs,\n\t\t\tproject,\n\t\t\turl: normalizedUrl,\n\t\t\tprovider: azure,\n\t\t} satisfies AzureProviderState;\n\t},\n\n\tresolveRaw: async (state, resourcePath) => {\n\t\t// essentially assert that we are using the correct state\n\t\tif (state.provider.name !== azure.name) {\n\t\t\tthrow new Error(\n\t\t\t\t`You passed the incorrect state object (${state.provider.name}) to the ${azure.name} provider.`\n\t\t\t);\n\t\t}\n\n\t\tconst { owner, repoName, project, ref, refs } = state as AzureProviderState;\n\n\t\tconst versionType = refs === 'tags' ? 'tag' : 'branch';\n\n\t\treturn new URL(\n\t\t\t`https://dev.azure.com/${owner}/${project}/_apis/git/repositories/${repoName}/items?path=${resourcePath}&api-version=7.2-preview.1&versionDescriptor.version=${ref}&versionDescriptor.versionType=${versionType}`\n\t\t);\n\t},\n\n\tauthHeader: (token) => ['Authorization', `Bearer ${token}`],\n\n\tformatFetchError: (state, filePath) => {\n\t\treturn `There was an error fetching \\`${color.bold(filePath)}\\` from ${color.bold(state.url)}.\n\n${color.bold('This may be for one of the following reasons:')}\n1. Either \\`${color.bold(filePath)}\\` or the containing repository doesn't exist\n2. Your repository path is incorrect (wrong branch, wrong tag)\n3. You are using an expired access token or a token that doesn't have access to this repository\n`;\n\t},\n};\n\nconst parseUrl = (\n\turl: string,\n\t{ fullyQualified }: ParseOptions\n): {\n\turl: string;\n\towner: string;\n\tproject: string;\n\trepoName: string;\n\tref: string;\n\trefs: 'tags' | 'heads';\n\tspecifier?: string;\n} => {\n\tconst repo = url.replaceAll(/(azure\\/)/g, '');\n\n\tlet [owner, project, repoName, ...rest] = repo.split('/');\n\n\tlet specifier: string | undefined = undefined;\n\n\tif (fullyQualified) {\n\t\tspecifier = rest.slice(rest.length - 2).join('/');\n\n\t\trest = rest.slice(0, rest.length - 2);\n\t}\n\n\tlet ref: string = DEFAULT_BRANCH;\n\n\t// checks if the type of the ref is tags or heads\n\tlet refs: 'heads' | 'tags' = 'heads';\n\n\tif (['tags', 'heads'].includes(rest[0])) {\n\t\trefs = rest[0] as 'heads' | 'tags';\n\n\t\tif (rest[1] && rest[1] !== '') {\n\t\t\tref = rest[1];\n\t\t}\n\t}\n\n\treturn {\n\t\turl: `azure/${owner}/${project}/${repoName}${ref ? `/${refs}/${ref}` : ''}`,\n\t\towner: owner,\n\t\trepoName: repoName,\n\t\tproject,\n\t\tref,\n\t\trefs,\n\t\tspecifier,\n\t};\n};\n","/** Returns true if `str` starts with one of the provided `strings`.\n *\n * ## Usage\n * ```ts\n * startsWithOneOf('a', 'a', 'b'); // true\n * startsWithOneOf('c', 'a', 'b'); // false\n * ```\n *\n * @param str\n * @param strings\n * @returns\n */\nconst startsWithOneOf = (str: string, strings: string[]): boolean => {\n\tfor (const s of strings) {\n\t\tif (str.startsWith(s)) return true;\n\t}\n\n\treturn false;\n};\n\nexport { startsWithOneOf };\n","import color from 'chalk';\nimport { startsWithOneOf } from '../blocks/utils/strings';\nimport type { ParseOptions, RegistryProvider, RegistryProviderState } from './types';\n\nconst DEFAULT_BRANCH = 'master';\n\nexport interface BitBucketProviderState extends RegistryProviderState {\n\towner: string;\n\trepoName: string;\n\tref: string;\n}\n\n/** Valid paths\n *\n * `bitbucket/ieedan/std`\n *\n * `https://bitbucket.org/ieedan/std/src/main/`\n *\n * `https://bitbucket.org/ieedan/std/src/next/`\n *\n * `https://bitbucket.org/ieedan/std/src/v2.0.0/`\n *\n */\nexport const bitbucket: RegistryProvider = {\n\tname: 'bitbucket',\n\n\tmatches: (url) => startsWithOneOf(url.toLowerCase(), ['bitbucket', 'https://bitbucket.org']),\n\n\tparse: (url, opts) => {\n\t\tconst parsed = parseUrl(url, opts);\n\n\t\treturn {\n\t\t\turl: parsed.url,\n\t\t\tspecifier: parsed.specifier,\n\t\t};\n\t},\n\n\tbaseUrl: (url) => {\n\t\tconst { owner, repoName } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn `https://bitbucket.org/${owner}/${repoName}`;\n\t},\n\n\tstate: async (url, { token, fetch: f = fetch } = {}) => {\n\t\tlet { url: normalizedUrl, owner, repoName, ref } = parseUrl(url, { fullyQualified: false });\n\n\t\t// fetch default branch if ref was not provided\n\t\tif (ref === undefined) {\n\t\t\ttry {\n\t\t\t\tconst headers = new Headers();\n\n\t\t\t\tif (token !== undefined) {\n\t\t\t\t\tconst [key, value] = bitbucket.authHeader!(token);\n\n\t\t\t\t\theaders.append(key, value);\n\t\t\t\t}\n\n\t\t\t\tconst response = await f(\n\t\t\t\t\t`https://api.bitbucket.org/2.0/repositories/${owner}/${repoName}`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif (response.ok) {\n\t\t\t\t\tconst data = await response.json();\n\n\t\t\t\t\t// @ts-ignore yes but we know\n\t\t\t\t\tref = data.mainbranch.name as string;\n\t\t\t\t} else {\n\t\t\t\t\tref = DEFAULT_BRANCH;\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// well find out it isn't correct later with a better error\n\t\t\t\tref = DEFAULT_BRANCH;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\towner,\n\t\t\tref,\n\t\t\trepoName,\n\t\t\turl: normalizedUrl,\n\t\t\tprovider: bitbucket,\n\t\t} satisfies BitBucketProviderState;\n\t},\n\n\tresolveRaw: async (state, resourcePath) => {\n\t\t// essentially assert that we are using the correct state\n\t\tif (state.provider.name !== bitbucket.name) {\n\t\t\tthrow new Error(\n\t\t\t\t`You passed the incorrect state object (${state.provider.name}) to the ${bitbucket.name} provider.`\n\t\t\t);\n\t\t}\n\n\t\tconst { owner, repoName, ref } = state as BitBucketProviderState;\n\n\t\treturn new URL(\n\t\t\tresourcePath,\n\t\t\t`https://api.bitbucket.org/2.0/repositories/${owner}/${repoName}/src/${ref}/`\n\t\t);\n\t},\n\n\tauthHeader: (token) => ['Authorization', `Bearer ${token}`],\n\n\tformatFetchError: (state, filePath) => {\n\t\treturn `There was an error fetching \\`${color.bold(filePath)}\\` from ${color.bold(state.url)}.\n\n${color.bold('This may be for one of the following reasons:')}\n1. Either \\`${color.bold(filePath)}\\` or the containing repository doesn't exist\n2. Your repository path is incorrect (wrong branch, wrong tag)\n3. You are using an expired access token or a token that doesn't have access to this repository\n`;\n\t},\n};\n\nconst parseUrl = (\n\turl: string,\n\t{ fullyQualified = false }: ParseOptions\n): { url: string; owner: string; repoName: string; ref?: string; specifier?: string } => {\n\tconst repo = url.replaceAll(/(https:\\/\\/bitbucket.org\\/)|(bitbucket\\/)/g, '');\n\n\tlet [owner, repoName, ...rest] = repo.split('/');\n\n\tlet specifier: string | undefined;\n\n\tif (fullyQualified) {\n\t\tspecifier = rest.slice(rest.length - 2).join('/');\n\n\t\trest = rest.slice(0, rest.length - 2);\n\t}\n\n\tlet ref: string | undefined;\n\n\tif (rest[0] === 'src') {\n\t\tref = rest[1];\n\t}\n\n\treturn {\n\t\turl: `bitbucket/${owner}/${repoName}${ref ? `/src/${ref}` : ''}`,\n\t\tspecifier,\n\t\towner,\n\t\trepoName: repoName,\n\t\tref,\n\t};\n};\n","import color from 'chalk';\nimport { Octokit } from 'octokit';\nimport { startsWithOneOf } from '../blocks/utils/strings';\nimport type { ParseOptions, RegistryProvider, RegistryProviderState } from './types';\n\nconst DEFAULT_BRANCH = 'main';\n\nexport interface GitHubProviderState extends RegistryProviderState {\n\towner: string;\n\trepoName: string;\n\trefs: 'tags' | 'heads';\n\tref: string;\n}\n\n/** Valid paths\n *\n * `https://github.com/<owner>/<repo>`\n *\n * `github/<owner>/<repo>`\n *\n * `github/<owner>/<repo>/tree/<ref>`\n */\nexport const github: RegistryProvider = {\n\tname: 'github',\n\n\tmatches: (url) => startsWithOneOf(url.toLowerCase(), ['github', 'https://github.com']),\n\n\tparse: (url, opts) => {\n\t\tconst parsed = parseUrl(url, opts);\n\n\t\treturn {\n\t\t\turl: parsed.url,\n\t\t\tspecifier: parsed.specifier,\n\t\t};\n\t},\n\n\tbaseUrl: (url) => {\n\t\tconst { owner, repoName } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn `https://github.com/${owner}/${repoName}`;\n\t},\n\n\tstate: async (url, { token } = {}) => {\n\t\tlet { url: normalizedUrl, owner, repoName, ref } = parseUrl(url, { fullyQualified: false });\n\n\t\tconst octokit = new Octokit({ auth: token });\n\n\t\t// checks if the type of the ref is tags or heads\n\t\tlet refs: 'heads' | 'tags' = 'heads';\n\n\t\t// fetch default branch if ref was not provided\n\t\tif (ref === undefined) {\n\t\t\ttry {\n\t\t\t\tconst { data: repo } = await octokit.rest.repos.get({ owner, repo: repoName });\n\n\t\t\t\tref = repo.default_branch;\n\t\t\t} catch {\n\t\t\t\t// we just want to continue on blissfully unaware the user will get an error later\n\t\t\t\tref = DEFAULT_BRANCH;\n\t\t\t}\n\t\t} else {\n\t\t\t// no need to check if ref is main\n\n\t\t\t// this isn't a double case it's possible that DEFAULT_BRANCH and repo.default_branch are not equal\n\t\t\tif (ref !== DEFAULT_BRANCH) {\n\t\t\t\ttry {\n\t\t\t\t\tconst { data: tags } = await octokit.rest.git.listMatchingRefs({\n\t\t\t\t\t\towner,\n\t\t\t\t\t\trepo: repoName,\n\t\t\t\t\t\tref: 'tags',\n\t\t\t\t\t});\n\n\t\t\t\t\tif (tags.some((tag) => tag.ref === `refs/tags/${ref}`)) {\n\t\t\t\t\t\trefs = 'tags';\n\t\t\t\t\t}\n\t\t\t\t} catch {\n\t\t\t\t\trefs = 'heads';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\towner,\n\t\t\trefs,\n\t\t\tref,\n\t\t\trepoName,\n\t\t\turl: normalizedUrl,\n\t\t\tprovider: github,\n\t\t} satisfies GitHubProviderState;\n\t},\n\n\tresolveRaw: async (state, resourcePath) => {\n\t\t// essentially assert that we are using the correct state\n\t\tif (state.provider.name !== github.name) {\n\t\t\tthrow new Error(\n\t\t\t\t`You passed the incorrect state object (${state.provider.name}) to the ${github.name} provider.`\n\t\t\t);\n\t\t}\n\n\t\tconst { owner, repoName, refs, ref } = state as GitHubProviderState;\n\n\t\treturn new URL(\n\t\t\tresourcePath,\n\t\t\t`https://raw.githubusercontent.com/${owner}/${repoName}/refs/${refs}/${ref}/`\n\t\t);\n\t},\n\n\tauthHeader: (token) => ['Authorization', `token ${token}`],\n\n\tformatFetchError: (state, filePath) => {\n\t\treturn `There was an error fetching \\`${color.bold(filePath)}\\` from ${color.bold(state.url)}.\n\n${color.bold('This may be for one of the following reasons:')}\n1. Either \\`${color.bold(filePath)}\\` or the containing repository doesn't exist\n2. Your repository path is incorrect (wrong branch, wrong tag)\n3. You are using an expired access token or a token that doesn't have access to this repository\n`;\n\t},\n};\n\nconst parseUrl = (\n\turl: string,\n\t{ fullyQualified = false }: ParseOptions\n): { url: string; owner: string; repoName: string; ref?: string; specifier?: string } => {\n\tconst repo = url.replaceAll(/(https:\\/\\/github.com\\/)|(github\\/)/g, '');\n\n\tlet [owner, repoName, ...rest] = repo.split('/');\n\n\tlet specifier: string | undefined;\n\n\tif (fullyQualified) {\n\t\tspecifier = rest.slice(rest.length - 2).join('/');\n\n\t\trest = rest.slice(0, rest.length - 2);\n\t}\n\n\tlet ref: string | undefined;\n\n\tif (rest.length > 0) {\n\t\tif (rest[0] === 'tree') {\n\t\t\tref = rest[1];\n\t\t}\n\t}\n\n\treturn {\n\t\turl: `github/${owner}/${repoName}${ref ? `/tree/${ref}` : ''}`,\n\t\tspecifier,\n\t\towner,\n\t\trepoName: repoName,\n\t\tref,\n\t};\n};\n","import color from 'chalk';\nimport { startsWithOneOf } from '../blocks/utils/strings';\nimport type { ParseOptions, RegistryProvider, RegistryProviderState } from './types';\n\nconst DEFAULT_BRANCH = 'main';\n\nexport interface GitLabProviderState extends RegistryProviderState {\n\towner: string;\n\trepoName: string;\n\tref: string;\n}\n\n/** Valid paths\n *\n * `https://gitlab.com/ieedan/std`\n *\n * `https://gitlab.com/ieedan/std/-/tree/next`\n *\n * `https://gitlab.com/ieedan/std/-/tree/v2.0.0`\n *\n * `https://gitlab.com/ieedan/std/-/tree/v2.0.0?ref_type=tags`\n */\nexport const gitlab: RegistryProvider = {\n\tname: 'gitlab',\n\n\tmatches: (url) => startsWithOneOf(url.toLowerCase(), ['gitlab', 'https://gitlab.com']),\n\n\tparse: (url, opts) => {\n\t\tconst parsed = parseUrl(url, opts);\n\n\t\treturn {\n\t\t\turl: parsed.url,\n\t\t\tspecifier: parsed.specifier,\n\t\t};\n\t},\n\n\tbaseUrl: (url) => {\n\t\tconst { owner, repoName } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn `https://gitlab.com/${owner}/${repoName}`;\n\t},\n\n\tstate: async (url, { token, fetch: f = fetch } = {}) => {\n\t\tlet { url: normalizedUrl, owner, repoName, ref } = parseUrl(url, { fullyQualified: false });\n\n\t\t// fetch default branch if ref was not provided\n\t\tif (ref === undefined) {\n\t\t\ttry {\n\t\t\t\tconst headers = new Headers();\n\n\t\t\t\tif (token !== undefined) {\n\t\t\t\t\tconst [key, value] = gitlab.authHeader!(token);\n\n\t\t\t\t\theaders.append(key, value);\n\t\t\t\t}\n\n\t\t\t\tconst response = await f(\n\t\t\t\t\t`https://gitlab.com/api/v4/projects/${encodeURIComponent(`${owner}/${repoName}`)}`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif (response.ok) {\n\t\t\t\t\tconst data = await response.json();\n\n\t\t\t\t\t// @ts-ignore yes but we know\n\t\t\t\t\tref = data.default_branch as string;\n\t\t\t\t} else {\n\t\t\t\t\tref = DEFAULT_BRANCH;\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// well find out it isn't correct later with a better error\n\t\t\t\tref = DEFAULT_BRANCH;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\towner,\n\t\t\trepoName,\n\t\t\tref,\n\t\t\turl: normalizedUrl,\n\t\t\tprovider: gitlab,\n\t\t} satisfies GitLabProviderState;\n\t},\n\n\tresolveRaw: async (state, resourcePath) => {\n\t\t// essentially assert that we are using the correct state\n\t\tif (state.provider.name !== gitlab.name) {\n\t\t\tthrow new Error(\n\t\t\t\t`You passed the incorrect state object (${state.provider.name}) to the ${gitlab.name} provider.`\n\t\t\t);\n\t\t}\n\n\t\tconst { owner, repoName, ref } = state as GitLabProviderState;\n\n\t\treturn new URL(\n\t\t\t`${encodeURIComponent(resourcePath)}/raw?ref=${ref}`,\n\t\t\t`https://gitlab.com/api/v4/projects/${encodeURIComponent(`${owner}/${repoName}`)}/repository/files/`\n\t\t);\n\t},\n\n\tauthHeader: (token) => ['PRIVATE-TOKEN', token],\n\n\tformatFetchError: (state, filePath) => {\n\t\treturn `There was an error fetching \\`${color.bold(filePath)}\\` from ${color.bold(state.url)}.\n\n${color.bold('This may be for one of the following reasons:')}\n1. Either \\`${color.bold(filePath)}\\` or the containing repository doesn't exist\n2. Your repository path is incorrect (wrong branch, wrong tag)\n3. You are using an expired access token or a token that doesn't have access to this repository\n`;\n\t},\n};\n\nconst parseUrl = (\n\turl: string,\n\t{ fullyQualified }: ParseOptions\n): { url: string; owner: string; repoName: string; ref?: string; specifier?: string } => {\n\tconst repo = url.replaceAll(/(https:\\/\\/gitlab.com\\/)|(gitlab\\/)/g, '');\n\n\tlet [owner, repoName, ...rest] = repo.split('/');\n\n\tlet specifier: string | undefined;\n\n\tif (fullyQualified) {\n\t\tspecifier = rest.slice(rest.length - 2).join('/');\n\n\t\trest = rest.slice(0, rest.length - 2);\n\t}\n\n\tlet ref: string | undefined;\n\n\tif (rest[0] === '-' && rest[1] === 'tree') {\n\t\tif (rest[2].includes('?')) {\n\t\t\tconst [tempRef] = rest[2].split('?');\n\n\t\t\tref = tempRef;\n\t\t} else {\n\t\t\tref = rest[2];\n\t\t}\n\t}\n\n\treturn {\n\t\turl: `gitlab/${owner}/${repoName}${ref ? `/-/tree/${ref}` : ''}`,\n\t\towner: owner,\n\t\trepoName: repoName,\n\t\tref,\n\t\tspecifier,\n\t};\n};\n","/*\n\tjsrepo 1.28.2\n\tInstalled from github/ieedan/std\n\t1-23-2025\n*/\n\n/** Joins the segments into a single url correctly handling leading and trailing slashes in each segment.\n *\n * ## Usage\n * ```ts\n * const url = join('https://example.com', '', 'api/', '/examples/');\n *\n * console.log(url); // https://example.com/api/examples\n * ```\n *\n * @param segments\n * @returns\n */\nconst join = (...segments: string[]) => {\n\treturn segments\n\t\t.map((s) => removeLeadingAndTrailingSlash(s))\n\t\t.filter(Boolean)\n\t\t.join('/');\n};\n\n/** Removes the leading and trailing slash from the segment (if they exist)\n * ## Usage\n * ```ts\n * const segment = removeLeadingAndTrailingSlash('/example/');\n *\n * console.log(segment); // 'example'\n * ```\n *\n * @param segment\n * @returns\n */\nconst removeLeadingAndTrailingSlash = (segment: string) => {\n\tconst newSegment = removeLeadingSlash(segment);\n\treturn removeTrailingSlash(newSegment);\n};\n\n/** Adds a leading and trailing to the beginning and end of the segment (if it doesn't already exist)\n *\n * ## Usage\n * ```ts\n * const segment = addLeadingAndTrailingSlash('example');\n *\n * console.log(segment); // '/example/'\n * ```\n *\n * @param segment\n * @returns\n */\nconst addLeadingAndTrailingSlash = (segment: string) => {\n\t// this is a weird case so feel free to handle it however you think it makes the most sense\n\tif (segment === '') return '//';\n\n\tconst newSegment = addLeadingSlash(segment);\n\treturn addTrailingSlash(newSegment);\n};\n\n/** Removes the leading slash from the beginning of the segment (if it exists)\n *\n * ## Usage\n * ```ts\n * const segment = removeLeadingSlash('/example');\n *\n * console.log(segment); // 'example'\n * ```\n *\n * @param segment\n * @returns\n */\nconst removeLeadingSlash = (segment: string): string => {\n\tlet newSegment = segment;\n\tif (newSegment.startsWith('/')) {\n\t\tnewSegment = newSegment.slice(1);\n\t}\n\n\treturn newSegment;\n};\n\n/** Adds a leading slash to the beginning of the segment (if it doesn't already exist)\n *\n * ## Usage\n * ```ts\n * const segment = addLeadingSlash('example');\n *\n * console.log(segment); // '/example'\n * ```\n *\n * @param segment\n * @returns\n */\nconst addLeadingSlash = (segment: string): string => {\n\tlet newSegment = segment;\n\tif (!newSegment.startsWith('/')) {\n\t\tnewSegment = `/${newSegment}`;\n\t}\n\n\treturn newSegment;\n};\n\n/** Removes the trailing slash from the end of the segment (if it exists)\n *\n * ## Usage\n * ```ts\n * const segment = removeTrailingSlash('example/');\n *\n * console.log(segment); // 'example'\n * ```\n * @param segment\n * @returns\n */\nconst removeTrailingSlash = (segment: string): string => {\n\tlet newSegment = segment;\n\tif (newSegment.endsWith('/')) {\n\t\tnewSegment = newSegment.slice(0, newSegment.length - 1);\n\t}\n\n\treturn newSegment;\n};\n\n/** Adds a trailing slash to the end of the segment (if it doesn't already exist)\n *\n * ## Usage\n * ```ts\n * const segment = addTrailingSlash('example');\n *\n * console.log(segment); // 'example/'\n * ```\n *\n * @param segment\n * @returns\n */\nconst addTrailingSlash = (segment: string): string => {\n\tlet newSegment = segment;\n\tif (!newSegment.endsWith('/')) {\n\t\tnewSegment = `${newSegment}/`;\n\t}\n\n\treturn newSegment;\n};\n\n/** Removes the last segment of the url.\n *\n * ## Usage\n * ```ts\n * const url = upOneLevel('/first/second');\n *\n * console.log(url); // '/first'\n * ```\n *\n * @param url\n */\nconst upOneLevel = (url: string): string => {\n\tif (url === '/') return url;\n\n\tconst lastIndex = removeTrailingSlash(url).lastIndexOf('/');\n\n\treturn url.slice(0, url.length - lastIndex - 1);\n};\n\nexport {\n\tjoin,\n\tremoveLeadingSlash,\n\tremoveTrailingSlash,\n\taddTrailingSlash,\n\taddLeadingSlash,\n\taddLeadingAndTrailingSlash,\n\tremoveLeadingAndTrailingSlash,\n\tupOneLevel,\n};\n","import color from 'chalk';\nimport * as u from '../blocks/utils/url';\nimport type { ParseOptions, RegistryProvider, RegistryProviderState } from './types';\n\nexport interface HttpProviderState extends RegistryProviderState {}\n\n/** Valid paths\n *\n *  `(https|http)://example.com`\n */\nexport const http: RegistryProvider = {\n\tname: 'http',\n\n\tmatches: (url) => url.toLowerCase().startsWith('http'),\n\n\tparse: (url, opts) => {\n\t\tconst parsed = parseUrl(url, opts);\n\n\t\treturn {\n\t\t\turl: parsed.url,\n\t\t\tspecifier: parsed.specifier,\n\t\t};\n\t},\n\n\tbaseUrl: (url) => {\n\t\tconst { url: u } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn new URL(u).origin;\n\t},\n\n\tstate: async (url) => {\n\t\tconst { url: normalizedUrl } = parseUrl(url, { fullyQualified: false });\n\n\t\treturn {\n\t\t\turl: normalizedUrl,\n\t\t\tprovider: http,\n\t\t} satisfies HttpProviderState;\n\t},\n\n\tresolveRaw: async (state, resourcePath) => {\n\t\t// essentially assert that we are using the correct state\n\t\tif (state.provider.name !== http.name) {\n\t\t\tthrow new Error(\n\t\t\t\t`You passed the incorrect state object (${state.provider.name}) to the ${http.name} provider.`\n\t\t\t);\n\t\t}\n\n\t\treturn new URL(resourcePath, state.url);\n\t},\n\n\tformatFetchError: (state, filePath, error) => {\n\t\treturn `There was an error fetching ${color.bold(new URL(filePath, state.url).toString())}\n\t\n${color.bold(error)}`;\n\t},\n};\n\nconst parseUrl = (\n\turl: string,\n\t{ fullyQualified }: ParseOptions\n): {\n\turl: string;\n\tspecifier?: string;\n} => {\n\tconst parsedUrl = new URL(url);\n\n\tlet segments = parsedUrl.pathname.split('/');\n\n\tlet specifier: string | undefined;\n\n\tif (fullyQualified) {\n\t\tspecifier = segments.slice(segments.length - 2).join('/');\n\n\t\tsegments = segments.slice(0, segments.length - 2);\n\t}\n\n\treturn {\n\t\turl: u.addTrailingSlash(u.join(parsedUrl.origin, ...segments)),\n\t\tspecifier,\n\t};\n};\n","/*\n\tjsrepo 1.2.4\n\tInstalled from github/ieedan/std\n\t11-21-2024\n*/\n\n/** This is just a helper type used only within this file */\ntype _Result<T, E> = { ok: true; val: T } | { ok: false; err: E };\n\n/** Result allows you to show to a consumer that a function might throw and force them to handle it.\n *\n *  `T` Value type\n *\n *  `E` Error type\n *\n * ## Usage\n *\n * ```ts\n * function functionThatMightFail(): Result<T, E>;\n * ```\n *\n * ## Examples\n *\n * ```ts\n * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello, World!\");\n *\n * const result = functionThatMightFail();\n *\n * console.log(result.unwrap()); // \"Hello, World!\"\n * ```\n */\nclass Result<T, E> {\n\tprivate readonly _result: _Result<T, E>;\n\n\tconstructor(result: _Result<T, E>) {\n\t\tthis._result = result;\n\t}\n\n\t/** Allows you to run callbacks based on the result.\n\t *\n\t * @param success callback to be run when result is success\n\t * @param failure callback to be run when result is failure\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.match(\n\t * \t(val) => val,\n\t * \t() => {\n\t * \t\tthrow new Error('oops!')\n\t * \t}\n\t * );\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello, World!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const val = result.match(\n\t * \t(val) => val,\n\t * \t() => {\n\t * \t\tthrow new Error('oops!')\n\t * \t}\n\t * );\n\t *\n\t * console.log(val); // \"Hello, World!\"\n\t * ```\n\t */\n\tmatch<A, B = A>(success: (val: T) => A, failure: (err: E) => B): A | B {\n\t\tif (!this._result.ok) {\n\t\t\treturn failure(this._result.err);\n\t\t}\n\n\t\treturn success(this._result.val);\n\t}\n\n\t/** Maps `Result<T, E>` to `Result<A, E>` using the passed mapping function\n\t *\n\t * @param fn Mapping function\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.map((val) => val.length);\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello, World!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const hello = result.map((val) => val.slice(0, 5));\n\t *\n\t * console.log(hello.unwrap()); // \"Hello\"\n\t * ```\n\t */\n\tmap<A>(fn: (val: T) => A): Result<A, E> {\n\t\treturn this.match(\n\t\t\t(val) => Ok(fn(val)),\n\t\t\t(err) => Err(err)\n\t\t);\n\t}\n\n\t/** In the `Ok` case returns the mapped value using the function else returns `defaultVal`\n\t *\n\t * @param defaultVal Value to be returned when `Err`\n\t * @param fn Mapping function to map in case of `Ok`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.mapOr(1, (val) => val.length);\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"foo\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapOr(1, (val) => val.length);\n\t *\n\t * console.log(length); // 3\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapOr(1, (val) => val.length);\n\t *\n\t * console.log(length); // 1\n\t * ```\n\t */\n\tmapOr<A>(defaultVal: A, fn: (val: T) => A): A {\n\t\treturn this.match(\n\t\t\t(val) => fn(val),\n\t\t\t(_) => defaultVal\n\t\t);\n\t}\n\n\t/** In the `Ok` case returns the mapped value using `fn` else returns value of `def`\n\t *\n\t * @param def Mapping function called when `Err`\n\t * @param fn Mapping function called when `Ok`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.mapOrElse(() => 1, (val) => val.length);\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"foo\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapOrElse(() => 1, (val) => val.length);\n\t *\n\t * console.log(length); // 3\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapOr(() => 1, (val) => val.length);\n\t *\n\t * console.log(length); // 1\n\t * ```\n\t */\n\tmapOrElse<A>(def: (err: E) => A, fn: (val: T) => A): A {\n\t\treturn this.match(\n\t\t\t(val) => fn(val),\n\t\t\t(err) => def(err)\n\t\t);\n\t}\n\n\t/** Maps `Result<T, E>` to `Result<T, A>` using the passed mapping function\n\t *\n\t * @param fn Mapping function\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.mapErr((err) => getCodeMsg(err));\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(10);\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const message = result.mapErr(() => \"Error\");\n\t *\n\t * console.log(message); // \"Error\"\n\t * ```\n\t */\n\tmapErr<A>(fn: (err: E) => A): Result<T, A> {\n\t\treturn this.match(\n\t\t\t(val) => Ok(val),\n\t\t\t(err) => Err(fn(err))\n\t\t);\n\t}\n\n\t/** In the `Err` case returns the mapped value using the function else returns `defaultVal`\n\t *\n\t * @param defaultVal Value to be returned when `Ok`\n\t * @param fn Mapping function to map in case of `Err`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.mapErrOr(\"Should've been error\", (err) => getCodeMsg(err));\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"foo\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const message = result.mapErrOr(\"Should've been error\", () => \"Error\");\n\t *\n\t * console.log(message); // \"Should've been error\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(10);\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const message = result.mapErrOr(\"Should've been error\", () => \"Error\");\n\t *\n\t * console.log(message); // \"Error\"\n\t * ```\n\t */\n\tmapErrOr<A>(defaultVal: A, fn: (err: E) => A): A {\n\t\treturn this.match(\n\t\t\t(_) => defaultVal,\n\t\t\t(err) => fn(err)\n\t\t);\n\t}\n\n\t/** In the `Err` case returns the mapped value using the function else returns value of `def`\n\t *\n\t * @param def Mapping function called when `Ok`\n\t * @param fn Mapping function called when `Err`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.mapErrOrElse(() => \"Value\", (_) => \"Error!\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"foo\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapErrOrElse(() => 1, (val) => val.length);\n\t *\n\t * console.log(length); // 1\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * const length = result.mapOr(() => 1, (val) => val.length);\n\t *\n\t * console.log(length); // 4\n\t * ```\n\t */\n\tmapErrOrElse<A>(def: (val: T) => A, fn: (err: E) => A): A {\n\t\treturn this.match(\n\t\t\t(val) => def(val),\n\t\t\t(err) => fn(err)\n\t\t);\n\t}\n\n\t/** Returns true if result is `Ok`\n\t *\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.isOk();\n\t * ```\n\t */\n\tisOk(): boolean {\n\t\treturn this.match(\n\t\t\t() => true,\n\t\t\t() => false\n\t\t);\n\t}\n\n\t/** Returns true if result is `Err`\n\t *\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.isErr();\n\t * ```\n\t */\n\tisErr(): boolean {\n\t\treturn this.match(\n\t\t\t() => false,\n\t\t\t() => true\n\t\t);\n\t}\n\n\t/** Tries to return value if value is `Err` throws generic error message.\n\t *\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrap();\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrap()); // \"Hello!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * result.unwrap(); // Error: Attempted to call `.unwrap()` on a non `Ok` value.\n\t * ```\n\t */\n\tunwrap(): T {\n\t\treturn this.match(\n\t\t\t(val) => val,\n\t\t\t() => {\n\t\t\t\tthrow new Error('Attempted to call `.unwrap()` on a non `Ok` value.');\n\t\t\t}\n\t\t);\n\t}\n\n\t/** Tries to return err if value is `Ok` throws generic error message.\n\t *\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrapErr();\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * result.unwrapErr(); // Error: Attempted to call `.unwrapErr()` on a non `Err` value.\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapErr()); // \"oops!\"\n\t * ```\n\t */\n\tunwrapErr(): E {\n\t\treturn this.match(\n\t\t\t() => {\n\t\t\t\tthrow new Error('Attempted to call `.unwrapErr()` on a non `Err` value.');\n\t\t\t},\n\t\t\t(err) => err\n\t\t);\n\t}\n\n\t/** Tries to unwrap the value if value is `Err` returns `defaultVal`\n\t *\n\t * @param defaultVal Value to be returned if `Err`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrapOr(7);\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapOr(\"Yellow!\")); // \"Hello!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapOr(\"Yellow!\")); // \"Yellow!\"\n\t * ```\n\t */\n\tunwrapOr(defaultVal: T): T {\n\t\treturn this.match(\n\t\t\t(val) => val,\n\t\t\t(_) => defaultVal\n\t\t);\n\t}\n\n\t/** Tries to unwrap the error if vale is `Ok` returns `defaultVal`\n\t *\n\t * @param defaultVal\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrapErrOr(\"Error\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapErrOr(\"Yellow!\")); // \"Yellow!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapErrOr(\"Yellow!\")); // \"oops!\"\n\t * ```\n\t */\n\tunwrapErrOr(defaultVal: E): E {\n\t\treturn this.match(\n\t\t\t() => defaultVal,\n\t\t\t(err) => err\n\t\t);\n\t}\n\n\t/** Tries to return the value if value is `Err` calls `fn`\n\t *\n\t * @param fn Function called if `Err`\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrapOrElse(() => \"Hello!\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapOrElse(() => \"oops!\")); // \"Hello!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapOrElse(() => \"Hello!\")); // \"Hello!\"\n\t * ```\n\t *\n\t */\n\tunwrapOrElse(fn: (err: E) => T): T {\n\t\treturn this.match(\n\t\t\t(val) => val,\n\t\t\t(err) => fn(err)\n\t\t);\n\t}\n\n\t/** Tries to return the error if value is `Ok` calls `fn`\n\t *\n\t * @param fn Function called if `Ok`\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.unwrapErrOrElse(() => \"Error!\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapErrOrElse(() => \"oops!\")); // \"oops!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.unwrapErrOrElse(() => \"Hello!\")); // \"oops!\"\n\t * ```\n\t *\n\t */\n\tunwrapErrOrElse(fn: (val: T) => E): E {\n\t\treturn this.match(\n\t\t\t(val) => fn(val),\n\t\t\t(err) => err\n\t\t);\n\t}\n\n\t/** Tries to return value if value is `Err` throws custom error message.\n\t *\n\t * @param message Message to show when value is `Err`\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.expect(\"Custom message\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.expect(\"I failed!\")); // \"Hello!\"\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * result.expect(\"I failed!\"); // Error: I failed!\n\t * ```\n\t */\n\texpect(message: string): T {\n\t\treturn this.match(\n\t\t\t(val) => val,\n\t\t\t() => {\n\t\t\t\tthrow new Error(message);\n\t\t\t}\n\t\t);\n\t}\n\n\t/** Tries to return error value if value is `Ok` throws custom error message\n\t *\n\t * @param message\n\t * @returns\n\t *\n\t * ## Usage\n\t *\n\t * ```ts\n\t * result.expectErr(\"Custom message\");\n\t * ```\n\t *\n\t * ## Examples\n\t *\n\t * ### When `Ok`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Ok(\"Hello!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.expectErr(\"I failed!\")); // Error: I failed!\n\t * ```\n\t *\n\t * ### When `Err`\n\t *\n\t * ```ts\n\t * const functionThatMightFail = (): Result<string, string> => Err(\"oops!\");\n\t *\n\t * const result = functionThatMightFail();\n\t *\n\t * console.log(result.expectErr(\"I failed!\")); // \"oops!\"\n\t * ```\n\t */\n\texpectErr(message: string): E {\n\t\treturn this.match(\n\t\t\t() => {\n\t\t\t\tthrow new Error(message);\n\t\t\t},\n\t\t\t(err) => err\n\t\t);\n\t}\n}\n\n/** Returns a new `Ok` result type with the provided value\n *\n * @param val Value of the result\n * @returns\n *\n * ## Usage\n *\n * ```ts\n * Ok(true);\n * ```\n *\n * ## Examples\n *\n * ```ts\n * const functionThatCanFail = (condition) => {\n * \tif (condition) {\n * \t\tOk(\"Success\")\n * \t}\n *\n * \treturn Err(\"Failure\");\n * }\n * ```\n */\nconst Ok = <T>(val: T): Result<T, never> => {\n\treturn new Result<T, never>({ ok: true, val });\n};\n\n/** Returns a new `Err` result type with the provided error\n *\n * @param err Error of the result\n * @returns\n *\n * ## Usage\n *\n * ```ts\n * Err(\"I failed!\");\n * ```\n *\n * ## Examples\n *\n * ```ts\n * const functionThatCanFail = (condition) => {\n * \tif (condition) {\n * \t\tOk(\"Success\")\n * \t}\n *\n * \treturn Err(\"Failure\");\n * }\n * ```\n */\nconst Err = <E>(err: E): Result<never, E> => {\n\treturn new Result<never, E>({ ok: false, err });\n};\n\nexport { type Result, Ok, Err };\n","import * as v from 'valibot';\nimport { type Manifest, categorySchema, manifestSchema } from '../types';\nimport { Err, Ok, type Result } from './blocks/types/result';\n\n/** Parses the json string (if it can be) into a manifest.\n *\n * @param json\n */\nexport const parseManifest = (json: string): Result<Manifest, string> => {\n\tlet parsed: unknown;\n\n\ttry {\n\t\tparsed = JSON.parse(json);\n\t} catch (err) {\n\t\treturn Err(`Error parsing manifest json ${err}`);\n\t}\n\n\t// first gen array-based config\n\tif (Array.isArray(parsed)) {\n\t\tconst validated = v.safeParse(v.array(categorySchema), parsed);\n\n\t\tif (!validated.success) {\n\t\t\treturn Err(\n\t\t\t\t`Error parsing categories (array-based config) ${validated.issues.join(' ')}`\n\t\t\t);\n\t\t}\n\n\t\treturn Ok({\n\t\t\tcategories: validated.output,\n\t\t});\n\t}\n\n\tconst validated = v.safeParse(manifestSchema, parsed);\n\n\tif (!validated.success) {\n\t\treturn Err(`Error parsing manifest ${validated.issues.join(' ')}`);\n\t}\n\n\treturn Ok(validated.output);\n};\n","import { MANIFEST_FILE } from '../../constants';\nimport type { Manifest } from '../../types';\nimport { Err, Ok, type Result } from '../blocks/types/result';\nimport { parseManifest } from '../manifest';\nimport { azure } from './azure';\nimport { bitbucket } from './bitbucket';\nimport { github } from './github';\nimport { gitlab } from './gitlab';\nimport { http } from './http';\nimport type { RegistryProvider, RegistryProviderState } from './types';\n\nexport const providers = [github, gitlab, bitbucket, azure, http];\n\nexport const selectProvider = (url: string): RegistryProvider | undefined => {\n\tconst provider = providers.find((p) => p.matches(url));\n\n\treturn provider;\n};\n\nexport type FetchOptions = {\n\ttoken: string;\n\t/** Override the fetch method. If you are using this in a node environment you will want to pass `node-fetch` */\n\tfetch?: typeof fetch;\n\tverbose: (str: string) => void;\n};\n\nexport const fetchRaw = async (\n\tstate: RegistryProviderState,\n\tresourcePath: string,\n\t{ verbose, fetch: f = fetch, token }: Partial<FetchOptions> = {}\n): Promise<Result<string, string>> => {\n\tconst url = await state.provider.resolveRaw(state, resourcePath);\n\n\tverbose?.(`Trying to fetch from ${url}`);\n\n\ttry {\n\t\tconst headers = new Headers();\n\n\t\tif (token !== undefined && state.provider.authHeader) {\n\t\t\tconst [key, value] = state.provider.authHeader(token);\n\n\t\t\theaders.append(key, value);\n\t\t}\n\n\t\tconst response = await f(url, { headers });\n\n\t\tverbose?.(`Got a response from ${url} ${response.status} ${response.statusText}`);\n\n\t\tif (!response.ok) {\n\t\t\treturn Err(\n\t\t\t\tstate.provider.formatFetchError(\n\t\t\t\t\tstate,\n\t\t\t\t\tresourcePath,\n\t\t\t\t\t`${response.status} ${response.statusText}`\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn Ok(await response.text());\n\t} catch (err) {\n\t\treturn Err(state.provider.formatFetchError(state, resourcePath, err));\n\t}\n};\n\nexport const fetchManifest = async (\n\tstate: RegistryProviderState,\n\t{ fetch: f = fetch, ...rest }: Partial<FetchOptions> = {}\n): Promise<Result<Manifest, string>> => {\n\tconst manifest = await fetchRaw(state, MANIFEST_FILE, { fetch: f, ...rest });\n\n\tif (manifest.isErr()) return Err(manifest.unwrapErr());\n\n\treturn parseManifest(manifest.unwrap());\n};\n\nexport * from './types';\n\nexport { github, gitlab, bitbucket, azure, http };\n"]}